{"id":"index.js","dependencies":[{"name":"/home/disco/code/chat-server/demo/package.json","includedInParent":true,"mtime":1628037035828},{"name":"./Main.elm","loc":{"line":1,"column":18},"parent":"/home/disco/code/chat-server/demo/src/index.js","resolved":"/home/disco/code/chat-server/demo/src/Main.elm"}],"generated":{"js":"\"use strict\";\n\nvar _Main = require(\"./Main.elm\");\n\nvar _app$ports, _app$ports3, _app$ports7;\n\nvar webSocketAddress = \"ws://localhost/api/\";\n\nvar app = _Main.Elm.Main.init();\n\nvar connection = null;\n\nfunction close() {\n  if (connection && connection.close) {\n    connection.close();\n    connection = null;\n  }\n}\n\n(_app$ports = app.ports) === null || _app$ports === void 0 ? void 0 : _app$ports.close.subscribe(close);\n\nfunction getNewConnection() {\n  try {\n    console.log(webSocketAddress);\n    return new WebSocket(webSocketAddress);\n  } catch (e) {\n    var _app$ports2;\n\n    console.error(e);\n    (_app$ports2 = app.ports) === null || _app$ports2 === void 0 ? void 0 : _app$ports2.receive.send({\n      type: 'FAILED_TO_CONNECT'\n    });\n  }\n}\n\n(_app$ports3 = app.ports) === null || _app$ports3 === void 0 ? void 0 : _app$ports3.connect.subscribe(function (message) {\n  close();\n  connection = getNewConnection();\n  connection.addEventListener('close', function () {\n    var _app$ports4;\n\n    (_app$ports4 = app.ports) === null || _app$ports4 === void 0 ? void 0 : _app$ports4.receive.send({\n      type: 'DISCONNECTED'\n    });\n  });\n  connection.addEventListener('message', function (event) {\n    var payload = JSON.parse(event === null || event === void 0 ? void 0 : event.data);\n\n    if (typeof payload === 'string') {\n      var _app$ports5;\n\n      (_app$ports5 = app.ports) === null || _app$ports5 === void 0 ? void 0 : _app$ports5.receive.send({\n        type: 'CONNECTED',\n        userId: payload\n      });\n    } else {\n      var _app$ports6;\n\n      (_app$ports6 = app.ports) === null || _app$ports6 === void 0 ? void 0 : _app$ports6.receive.send(payload);\n    }\n  });\n  connection.addEventListener('open', function () {\n    connection.send(JSON.stringify(message));\n  });\n});\n(_app$ports7 = app.ports) === null || _app$ports7 === void 0 ? void 0 : _app$ports7.send.subscribe(function (message) {\n  if (connection && connection.send) {\n    connection.send(JSON.stringify(message));\n  }\n});"},"sourceMaps":{"js":{"mappings":[{"generated":{"line":3,"column":0},"source":"index.js","original":{"line":1,"column":0}},{"generated":{"line":7,"column":0},"source":"index.js","original":{"line":3,"column":0}},{"name":"webSocketAddress","generated":{"line":7,"column":4},"source":"index.js","original":{"line":3,"column":6}},{"generated":{"line":7,"column":20},"source":"index.js","original":{"line":3,"column":22}},{"generated":{"line":7,"column":44},"source":"index.js","original":{"line":3,"column":0}},{"generated":{"line":9,"column":0},"source":"index.js","original":{"line":5,"column":0}},{"name":"app","generated":{"line":9,"column":4},"source":"index.js","original":{"line":5,"column":6}},{"generated":{"line":9,"column":7},"source":"index.js","original":{"line":5,"column":9}},{"name":"Elm","generated":{"line":9,"column":10},"source":"index.js","original":{"line":5,"column":12}},{"name":"Main","generated":{"line":9,"column":20},"source":"index.js","original":{"line":5,"column":16}},{"generated":{"line":9,"column":24},"source":"index.js","original":{"line":5,"column":12}},{"name":"init","generated":{"line":9,"column":25},"source":"index.js","original":{"line":5,"column":21}},{"generated":{"line":9,"column":29},"source":"index.js","original":{"line":5,"column":12}},{"generated":{"line":9,"column":31},"source":"index.js","original":{"line":5,"column":0}},{"generated":{"line":11,"column":0},"source":"index.js","original":{"line":7,"column":0}},{"name":"connection","generated":{"line":11,"column":4},"source":"index.js","original":{"line":7,"column":4}},{"generated":{"line":11,"column":14},"source":"index.js","original":{"line":7,"column":14}},{"generated":{"line":11,"column":17},"source":"index.js","original":{"line":7,"column":17}},{"generated":{"line":11,"column":21},"source":"index.js","original":{"line":7,"column":0}},{"generated":{"line":13,"column":0},"source":"index.js","original":{"line":9,"column":0}},{"name":"close","generated":{"line":13,"column":9},"source":"index.js","original":{"line":9,"column":9}},{"generated":{"line":13,"column":14},"source":"index.js","original":{"line":9,"column":0}},{"generated":{"line":13,"column":17},"source":"index.js","original":{"line":9,"column":17}},{"generated":{"line":14,"column":0},"source":"index.js","original":{"line":10,"column":2}},{"name":"connection","generated":{"line":14,"column":6},"source":"index.js","original":{"line":10,"column":6}},{"generated":{"line":14,"column":16},"source":"index.js","original":{"line":10,"column":16}},{"name":"connection","generated":{"line":14,"column":20},"source":"index.js","original":{"line":10,"column":20}},{"generated":{"line":14,"column":30},"source":"index.js","original":{"line":10,"column":30}},{"name":"close","generated":{"line":14,"column":31},"source":"index.js","original":{"line":10,"column":31}},{"generated":{"line":14,"column":36},"source":"index.js","original":{"line":10,"column":2}},{"generated":{"line":14,"column":38},"source":"index.js","original":{"line":10,"column":38}},{"name":"connection","generated":{"line":15,"column":0},"source":"index.js","original":{"line":11,"column":4}},{"name":"connection","generated":{"line":15,"column":4},"source":"index.js","original":{"line":11,"column":4}},{"generated":{"line":15,"column":14},"source":"index.js","original":{"line":11,"column":14}},{"name":"close","generated":{"line":15,"column":15},"source":"index.js","original":{"line":11,"column":15}},{"generated":{"line":15,"column":20},"source":"index.js","original":{"line":11,"column":4}},{"name":"connection","generated":{"line":16,"column":0},"source":"index.js","original":{"line":12,"column":4}},{"name":"connection","generated":{"line":16,"column":4},"source":"index.js","original":{"line":12,"column":4}},{"generated":{"line":16,"column":14},"source":"index.js","original":{"line":12,"column":14}},{"generated":{"line":16,"column":17},"source":"index.js","original":{"line":12,"column":17}},{"generated":{"line":16,"column":21},"source":"index.js","original":{"line":12,"column":4}},{"generated":{"line":17,"column":0},"source":"index.js","original":{"line":13,"column":3}},{"generated":{"line":18,"column":0},"source":"index.js","original":{"line":14,"column":1}},{"generated":{"line":20,"column":0},"source":"index.js","original":{"line":15,"column":0}},{"name":"app","generated":{"line":20,"column":14},"source":"index.js","original":{"line":15,"column":0}},{"generated":{"line":20,"column":17},"source":"index.js","original":{"line":15,"column":3}},{"name":"ports","generated":{"line":20,"column":18},"source":"index.js","original":{"line":15,"column":4}},{"generated":{"line":20,"column":23},"source":"index.js","original":{"line":15,"column":0}},{"name":"close","generated":{"line":20,"column":81},"source":"index.js","original":{"line":15,"column":11}},{"generated":{"line":20,"column":86},"source":"index.js","original":{"line":15,"column":0}},{"name":"subscribe","generated":{"line":20,"column":87},"source":"index.js","original":{"line":15,"column":17}},{"generated":{"line":20,"column":96},"source":"index.js","original":{"line":15,"column":0}},{"name":"close","generated":{"line":20,"column":97},"source":"index.js","original":{"line":15,"column":27}},{"generated":{"line":20,"column":102},"source":"index.js","original":{"line":15,"column":0}},{"generated":{"line":22,"column":0},"source":"index.js","original":{"line":17,"column":0}},{"name":"getNewConnection","generated":{"line":22,"column":9},"source":"index.js","original":{"line":17,"column":9}},{"generated":{"line":22,"column":25},"source":"index.js","original":{"line":17,"column":0}},{"generated":{"line":22,"column":28},"source":"index.js","original":{"line":17,"column":28}},{"generated":{"line":23,"column":0},"source":"index.js","original":{"line":18,"column":2}},{"generated":{"line":23,"column":6},"source":"index.js","original":{"line":18,"column":6}},{"name":"console","generated":{"line":24,"column":0},"source":"index.js","original":{"line":19,"column":4}},{"name":"console","generated":{"line":24,"column":4},"source":"index.js","original":{"line":19,"column":4}},{"generated":{"line":24,"column":11},"source":"index.js","original":{"line":19,"column":11}},{"name":"log","generated":{"line":24,"column":12},"source":"index.js","original":{"line":19,"column":12}},{"generated":{"line":24,"column":15},"source":"index.js","original":{"line":19,"column":4}},{"name":"webSocketAddress","generated":{"line":24,"column":16},"source":"index.js","original":{"line":19,"column":16}},{"generated":{"line":24,"column":32},"source":"index.js","original":{"line":19,"column":4}},{"generated":{"line":25,"column":0},"source":"index.js","original":{"line":20,"column":4}},{"generated":{"line":25,"column":11},"source":"index.js","original":{"line":20,"column":11}},{"name":"WebSocket","generated":{"line":25,"column":15},"source":"index.js","original":{"line":20,"column":15}},{"generated":{"line":25,"column":24},"source":"index.js","original":{"line":20,"column":11}},{"name":"webSocketAddress","generated":{"line":25,"column":25},"source":"index.js","original":{"line":20,"column":25}},{"generated":{"line":25,"column":41},"source":"index.js","original":{"line":20,"column":11}},{"generated":{"line":25,"column":42},"source":"index.js","original":{"line":20,"column":4}},{"generated":{"line":26,"column":0},"source":"index.js","original":{"line":21,"column":3}},{"generated":{"line":26,"column":3},"source":"index.js","original":{"line":18,"column":2}},{"generated":{"line":26,"column":4},"source":"index.js","original":{"line":22,"column":2}},{"name":"e","generated":{"line":26,"column":11},"source":"index.js","original":{"line":22,"column":8}},{"generated":{"line":26,"column":12},"source":"index.js","original":{"line":22,"column":2}},{"generated":{"line":26,"column":14},"source":"index.js","original":{"line":22,"column":11}},{"generated":{"line":27,"column":0},"source":"index.js","original":{"line":22,"column":11}},{"name":"console","generated":{"line":29,"column":0},"source":"index.js","original":{"line":23,"column":4}},{"name":"console","generated":{"line":29,"column":4},"source":"index.js","original":{"line":23,"column":4}},{"generated":{"line":29,"column":11},"source":"index.js","original":{"line":23,"column":11}},{"name":"error","generated":{"line":29,"column":12},"source":"index.js","original":{"line":23,"column":12}},{"generated":{"line":29,"column":17},"source":"index.js","original":{"line":23,"column":4}},{"name":"e","generated":{"line":29,"column":18},"source":"index.js","original":{"line":23,"column":18}},{"generated":{"line":29,"column":19},"source":"index.js","original":{"line":23,"column":4}},{"generated":{"line":30,"column":0},"source":"index.js","original":{"line":24,"column":4}},{"name":"app","generated":{"line":30,"column":19},"source":"index.js","original":{"line":24,"column":4}},{"generated":{"line":30,"column":22},"source":"index.js","original":{"line":24,"column":7}},{"name":"ports","generated":{"line":30,"column":23},"source":"index.js","original":{"line":24,"column":8}},{"generated":{"line":30,"column":28},"source":"index.js","original":{"line":24,"column":4}},{"name":"receive","generated":{"line":30,"column":88},"source":"index.js","original":{"line":24,"column":15}},{"generated":{"line":30,"column":95},"source":"index.js","original":{"line":24,"column":4}},{"name":"send","generated":{"line":30,"column":96},"source":"index.js","original":{"line":24,"column":23}},{"generated":{"line":30,"column":100},"source":"index.js","original":{"line":24,"column":4}},{"generated":{"line":30,"column":101},"source":"index.js","original":{"line":24,"column":28}},{"name":"type","generated":{"line":31,"column":0},"source":"index.js","original":{"line":25,"column":6}},{"name":"type","generated":{"line":31,"column":6},"source":"index.js","original":{"line":25,"column":6}},{"generated":{"line":31,"column":10},"source":"index.js","original":{"line":25,"column":10}},{"generated":{"line":31,"column":12},"source":"index.js","original":{"line":25,"column":12}},{"generated":{"line":32,"column":0},"source":"index.js","original":{"line":24,"column":28}},{"generated":{"line":32,"column":5},"source":"index.js","original":{"line":24,"column":4}},{"generated":{"line":33,"column":0},"source":"index.js","original":{"line":27,"column":3}},{"generated":{"line":34,"column":0},"source":"index.js","original":{"line":28,"column":1}},{"generated":{"line":36,"column":0},"source":"index.js","original":{"line":30,"column":0}},{"name":"app","generated":{"line":36,"column":15},"source":"index.js","original":{"line":30,"column":0}},{"generated":{"line":36,"column":18},"source":"index.js","original":{"line":30,"column":3}},{"name":"ports","generated":{"line":36,"column":19},"source":"index.js","original":{"line":30,"column":4}},{"generated":{"line":36,"column":24},"source":"index.js","original":{"line":30,"column":0}},{"name":"connect","generated":{"line":36,"column":84},"source":"index.js","original":{"line":30,"column":11}},{"generated":{"line":36,"column":91},"source":"index.js","original":{"line":30,"column":0}},{"name":"subscribe","generated":{"line":36,"column":92},"source":"index.js","original":{"line":30,"column":19}},{"generated":{"line":36,"column":101},"source":"index.js","original":{"line":30,"column":0}},{"generated":{"line":36,"column":102},"source":"index.js","original":{"line":30,"column":29}},{"name":"message","generated":{"line":36,"column":112},"source":"index.js","original":{"line":30,"column":30}},{"generated":{"line":36,"column":119},"source":"index.js","original":{"line":30,"column":29}},{"generated":{"line":36,"column":121},"source":"index.js","original":{"line":30,"column":42}},{"name":"close","generated":{"line":37,"column":0},"source":"index.js","original":{"line":31,"column":2}},{"name":"close","generated":{"line":37,"column":2},"source":"index.js","original":{"line":31,"column":2}},{"generated":{"line":37,"column":7},"source":"index.js","original":{"line":31,"column":7}},{"name":"connection","generated":{"line":38,"column":0},"source":"index.js","original":{"line":32,"column":2}},{"name":"connection","generated":{"line":38,"column":2},"source":"index.js","original":{"line":32,"column":2}},{"generated":{"line":38,"column":12},"source":"index.js","original":{"line":32,"column":12}},{"name":"getNewConnection","generated":{"line":38,"column":15},"source":"index.js","original":{"line":32,"column":15}},{"generated":{"line":38,"column":31},"source":"index.js","original":{"line":32,"column":31}},{"generated":{"line":38,"column":33},"source":"index.js","original":{"line":32,"column":2}},{"name":"connection","generated":{"line":39,"column":0},"source":"index.js","original":{"line":34,"column":2}},{"name":"connection","generated":{"line":39,"column":2},"source":"index.js","original":{"line":34,"column":2}},{"generated":{"line":39,"column":12},"source":"index.js","original":{"line":34,"column":12}},{"name":"addEventListener","generated":{"line":39,"column":13},"source":"index.js","original":{"line":34,"column":13}},{"generated":{"line":39,"column":29},"source":"index.js","original":{"line":34,"column":2}},{"generated":{"line":39,"column":30},"source":"index.js","original":{"line":34,"column":30}},{"generated":{"line":39,"column":37},"source":"index.js","original":{"line":34,"column":2}},{"generated":{"line":39,"column":39},"source":"index.js","original":{"line":34,"column":39}},{"generated":{"line":39,"column":51},"source":"index.js","original":{"line":34,"column":45}},{"generated":{"line":40,"column":0},"source":"index.js","original":{"line":34,"column":45}},{"generated":{"line":42,"column":0},"source":"index.js","original":{"line":35,"column":4}},{"name":"app","generated":{"line":42,"column":19},"source":"index.js","original":{"line":35,"column":4}},{"generated":{"line":42,"column":22},"source":"index.js","original":{"line":35,"column":7}},{"name":"ports","generated":{"line":42,"column":23},"source":"index.js","original":{"line":35,"column":8}},{"generated":{"line":42,"column":28},"source":"index.js","original":{"line":35,"column":4}},{"name":"receive","generated":{"line":42,"column":88},"source":"index.js","original":{"line":35,"column":15}},{"generated":{"line":42,"column":95},"source":"index.js","original":{"line":35,"column":4}},{"name":"send","generated":{"line":42,"column":96},"source":"index.js","original":{"line":35,"column":23}},{"generated":{"line":42,"column":100},"source":"index.js","original":{"line":35,"column":4}},{"generated":{"line":42,"column":101},"source":"index.js","original":{"line":35,"column":28}},{"name":"type","generated":{"line":43,"column":0},"source":"index.js","original":{"line":36,"column":6}},{"name":"type","generated":{"line":43,"column":6},"source":"index.js","original":{"line":36,"column":6}},{"generated":{"line":43,"column":10},"source":"index.js","original":{"line":36,"column":10}},{"generated":{"line":43,"column":12},"source":"index.js","original":{"line":36,"column":12}},{"generated":{"line":44,"column":0},"source":"index.js","original":{"line":35,"column":28}},{"generated":{"line":44,"column":5},"source":"index.js","original":{"line":35,"column":4}},{"generated":{"line":45,"column":0},"source":"index.js","original":{"line":38,"column":3}},{"generated":{"line":45,"column":3},"source":"index.js","original":{"line":34,"column":2}},{"name":"connection","generated":{"line":46,"column":0},"source":"index.js","original":{"line":40,"column":2}},{"name":"connection","generated":{"line":46,"column":2},"source":"index.js","original":{"line":40,"column":2}},{"generated":{"line":46,"column":12},"source":"index.js","original":{"line":40,"column":12}},{"name":"addEventListener","generated":{"line":46,"column":13},"source":"index.js","original":{"line":40,"column":13}},{"generated":{"line":46,"column":29},"source":"index.js","original":{"line":40,"column":2}},{"generated":{"line":46,"column":30},"source":"index.js","original":{"line":40,"column":30}},{"generated":{"line":46,"column":39},"source":"index.js","original":{"line":40,"column":2}},{"generated":{"line":46,"column":41},"source":"index.js","original":{"line":40,"column":41}},{"name":"event","generated":{"line":46,"column":51},"source":"index.js","original":{"line":40,"column":42}},{"generated":{"line":46,"column":56},"source":"index.js","original":{"line":40,"column":41}},{"generated":{"line":46,"column":58},"source":"index.js","original":{"line":40,"column":52}},{"generated":{"line":47,"column":0},"source":"index.js","original":{"line":41,"column":4}},{"name":"payload","generated":{"line":47,"column":8},"source":"index.js","original":{"line":41,"column":10}},{"generated":{"line":47,"column":15},"source":"index.js","original":{"line":41,"column":17}},{"name":"JSON","generated":{"line":47,"column":18},"source":"index.js","original":{"line":41,"column":20}},{"generated":{"line":47,"column":22},"source":"index.js","original":{"line":41,"column":24}},{"name":"parse","generated":{"line":47,"column":23},"source":"index.js","original":{"line":41,"column":25}},{"generated":{"line":47,"column":28},"source":"index.js","original":{"line":41,"column":20}},{"name":"event","generated":{"line":47,"column":29},"source":"index.js","original":{"line":41,"column":31}},{"generated":{"line":47,"column":34},"source":"index.js","original":{"line":41,"column":20}},{"name":"event","generated":{"line":47,"column":47},"source":"index.js","original":{"line":41,"column":31}},{"generated":{"line":47,"column":52},"source":"index.js","original":{"line":41,"column":20}},{"name":"event","generated":{"line":47,"column":75},"source":"index.js","original":{"line":41,"column":31}},{"generated":{"line":47,"column":80},"source":"index.js","original":{"line":41,"column":36}},{"name":"data","generated":{"line":47,"column":81},"source":"index.js","original":{"line":41,"column":38}},{"generated":{"line":47,"column":85},"source":"index.js","original":{"line":41,"column":20}},{"generated":{"line":47,"column":86},"source":"index.js","original":{"line":41,"column":4}},{"generated":{"line":49,"column":0},"source":"index.js","original":{"line":43,"column":4}},{"generated":{"line":49,"column":8},"source":"index.js","original":{"line":43,"column":8}},{"name":"payload","generated":{"line":49,"column":15},"source":"index.js","original":{"line":43,"column":15}},{"generated":{"line":49,"column":22},"source":"index.js","original":{"line":43,"column":8}},{"generated":{"line":49,"column":27},"source":"index.js","original":{"line":43,"column":27}},{"generated":{"line":49,"column":35},"source":"index.js","original":{"line":43,"column":4}},{"generated":{"line":49,"column":37},"source":"index.js","original":{"line":43,"column":37}},{"generated":{"line":50,"column":0},"source":"index.js","original":{"line":43,"column":37}},{"generated":{"line":52,"column":0},"source":"index.js","original":{"line":44,"column":6}},{"name":"app","generated":{"line":52,"column":21},"source":"index.js","original":{"line":44,"column":6}},{"generated":{"line":52,"column":24},"source":"index.js","original":{"line":44,"column":9}},{"name":"ports","generated":{"line":52,"column":25},"source":"index.js","original":{"line":44,"column":10}},{"generated":{"line":52,"column":30},"source":"index.js","original":{"line":44,"column":6}},{"name":"receive","generated":{"line":52,"column":90},"source":"index.js","original":{"line":44,"column":17}},{"generated":{"line":52,"column":97},"source":"index.js","original":{"line":44,"column":6}},{"name":"send","generated":{"line":52,"column":98},"source":"index.js","original":{"line":44,"column":25}},{"generated":{"line":52,"column":102},"source":"index.js","original":{"line":44,"column":6}},{"generated":{"line":52,"column":103},"source":"index.js","original":{"line":44,"column":30}},{"name":"type","generated":{"line":53,"column":0},"source":"index.js","original":{"line":45,"column":8}},{"name":"type","generated":{"line":53,"column":8},"source":"index.js","original":{"line":45,"column":8}},{"generated":{"line":53,"column":12},"source":"index.js","original":{"line":45,"column":12}},{"generated":{"line":53,"column":14},"source":"index.js","original":{"line":45,"column":14}},{"generated":{"line":53,"column":25},"source":"index.js","original":{"line":44,"column":30}},{"name":"userId","generated":{"line":54,"column":0},"source":"index.js","original":{"line":46,"column":8}},{"name":"userId","generated":{"line":54,"column":8},"source":"index.js","original":{"line":46,"column":8}},{"generated":{"line":54,"column":14},"source":"index.js","original":{"line":46,"column":14}},{"name":"payload","generated":{"line":54,"column":16},"source":"index.js","original":{"line":46,"column":16}},{"generated":{"line":55,"column":0},"source":"index.js","original":{"line":44,"column":30}},{"generated":{"line":55,"column":7},"source":"index.js","original":{"line":44,"column":6}},{"generated":{"line":56,"column":0},"source":"index.js","original":{"line":48,"column":5}},{"generated":{"line":56,"column":5},"source":"index.js","original":{"line":43,"column":4}},{"generated":{"line":56,"column":11},"source":"index.js","original":{"line":49,"column":9}},{"generated":{"line":57,"column":0},"source":"index.js","original":{"line":49,"column":9}},{"generated":{"line":59,"column":0},"source":"index.js","original":{"line":50,"column":6}},{"name":"app","generated":{"line":59,"column":21},"source":"index.js","original":{"line":50,"column":6}},{"generated":{"line":59,"column":24},"source":"index.js","original":{"line":50,"column":9}},{"name":"ports","generated":{"line":59,"column":25},"source":"index.js","original":{"line":50,"column":10}},{"generated":{"line":59,"column":30},"source":"index.js","original":{"line":50,"column":6}},{"name":"receive","generated":{"line":59,"column":90},"source":"index.js","original":{"line":50,"column":17}},{"generated":{"line":59,"column":97},"source":"index.js","original":{"line":50,"column":6}},{"name":"send","generated":{"line":59,"column":98},"source":"index.js","original":{"line":50,"column":25}},{"generated":{"line":59,"column":102},"source":"index.js","original":{"line":50,"column":6}},{"name":"payload","generated":{"line":59,"column":103},"source":"index.js","original":{"line":50,"column":30}},{"generated":{"line":59,"column":110},"source":"index.js","original":{"line":50,"column":6}},{"generated":{"line":60,"column":0},"source":"index.js","original":{"line":51,"column":5}},{"generated":{"line":61,"column":0},"source":"index.js","original":{"line":52,"column":3}},{"generated":{"line":61,"column":3},"source":"index.js","original":{"line":40,"column":2}},{"name":"connection","generated":{"line":62,"column":0},"source":"index.js","original":{"line":54,"column":2}},{"name":"connection","generated":{"line":62,"column":2},"source":"index.js","original":{"line":54,"column":2}},{"generated":{"line":62,"column":12},"source":"index.js","original":{"line":54,"column":12}},{"name":"addEventListener","generated":{"line":62,"column":13},"source":"index.js","original":{"line":54,"column":13}},{"generated":{"line":62,"column":29},"source":"index.js","original":{"line":54,"column":2}},{"generated":{"line":62,"column":30},"source":"index.js","original":{"line":54,"column":30}},{"generated":{"line":62,"column":36},"source":"index.js","original":{"line":54,"column":2}},{"generated":{"line":62,"column":38},"source":"index.js","original":{"line":54,"column":38}},{"generated":{"line":62,"column":50},"source":"index.js","original":{"line":54,"column":44}},{"name":"connection","generated":{"line":63,"column":0},"source":"index.js","original":{"line":55,"column":4}},{"name":"connection","generated":{"line":63,"column":4},"source":"index.js","original":{"line":55,"column":4}},{"generated":{"line":63,"column":14},"source":"index.js","original":{"line":55,"column":14}},{"name":"send","generated":{"line":63,"column":15},"source":"index.js","original":{"line":55,"column":15}},{"generated":{"line":63,"column":19},"source":"index.js","original":{"line":55,"column":4}},{"name":"JSON","generated":{"line":63,"column":20},"source":"index.js","original":{"line":55,"column":20}},{"generated":{"line":63,"column":24},"source":"index.js","original":{"line":55,"column":24}},{"name":"stringify","generated":{"line":63,"column":25},"source":"index.js","original":{"line":55,"column":25}},{"generated":{"line":63,"column":34},"source":"index.js","original":{"line":55,"column":20}},{"name":"message","generated":{"line":63,"column":35},"source":"index.js","original":{"line":55,"column":35}},{"generated":{"line":63,"column":42},"source":"index.js","original":{"line":55,"column":20}},{"generated":{"line":63,"column":43},"source":"index.js","original":{"line":55,"column":4}},{"generated":{"line":64,"column":0},"source":"index.js","original":{"line":56,"column":3}},{"generated":{"line":64,"column":3},"source":"index.js","original":{"line":54,"column":2}},{"generated":{"line":65,"column":0},"source":"index.js","original":{"line":57,"column":1}},{"generated":{"line":65,"column":1},"source":"index.js","original":{"line":30,"column":0}},{"generated":{"line":66,"column":0},"source":"index.js","original":{"line":59,"column":0}},{"name":"app","generated":{"line":66,"column":15},"source":"index.js","original":{"line":59,"column":0}},{"generated":{"line":66,"column":18},"source":"index.js","original":{"line":59,"column":3}},{"name":"ports","generated":{"line":66,"column":19},"source":"index.js","original":{"line":59,"column":4}},{"generated":{"line":66,"column":24},"source":"index.js","original":{"line":59,"column":0}},{"name":"send","generated":{"line":66,"column":84},"source":"index.js","original":{"line":59,"column":11}},{"generated":{"line":66,"column":88},"source":"index.js","original":{"line":59,"column":0}},{"name":"subscribe","generated":{"line":66,"column":89},"source":"index.js","original":{"line":59,"column":16}},{"generated":{"line":66,"column":98},"source":"index.js","original":{"line":59,"column":0}},{"generated":{"line":66,"column":99},"source":"index.js","original":{"line":59,"column":26}},{"name":"message","generated":{"line":66,"column":109},"source":"index.js","original":{"line":59,"column":27}},{"generated":{"line":66,"column":116},"source":"index.js","original":{"line":59,"column":26}},{"generated":{"line":66,"column":118},"source":"index.js","original":{"line":59,"column":39}},{"generated":{"line":67,"column":0},"source":"index.js","original":{"line":60,"column":2}},{"name":"connection","generated":{"line":67,"column":6},"source":"index.js","original":{"line":60,"column":6}},{"generated":{"line":67,"column":16},"source":"index.js","original":{"line":60,"column":16}},{"name":"connection","generated":{"line":67,"column":20},"source":"index.js","original":{"line":60,"column":20}},{"generated":{"line":67,"column":30},"source":"index.js","original":{"line":60,"column":30}},{"name":"send","generated":{"line":67,"column":31},"source":"index.js","original":{"line":60,"column":31}},{"generated":{"line":67,"column":35},"source":"index.js","original":{"line":60,"column":2}},{"generated":{"line":67,"column":37},"source":"index.js","original":{"line":60,"column":37}},{"name":"connection","generated":{"line":68,"column":0},"source":"index.js","original":{"line":61,"column":4}},{"name":"connection","generated":{"line":68,"column":4},"source":"index.js","original":{"line":61,"column":4}},{"generated":{"line":68,"column":14},"source":"index.js","original":{"line":61,"column":14}},{"name":"send","generated":{"line":68,"column":15},"source":"index.js","original":{"line":61,"column":15}},{"generated":{"line":68,"column":19},"source":"index.js","original":{"line":61,"column":4}},{"name":"JSON","generated":{"line":68,"column":20},"source":"index.js","original":{"line":61,"column":20}},{"generated":{"line":68,"column":24},"source":"index.js","original":{"line":61,"column":24}},{"name":"stringify","generated":{"line":68,"column":25},"source":"index.js","original":{"line":61,"column":25}},{"generated":{"line":68,"column":34},"source":"index.js","original":{"line":61,"column":20}},{"name":"message","generated":{"line":68,"column":35},"source":"index.js","original":{"line":61,"column":35}},{"generated":{"line":68,"column":42},"source":"index.js","original":{"line":61,"column":20}},{"generated":{"line":68,"column":43},"source":"index.js","original":{"line":61,"column":4}},{"generated":{"line":69,"column":0},"source":"index.js","original":{"line":62,"column":3}},{"generated":{"line":70,"column":0},"source":"index.js","original":{"line":63,"column":1}},{"generated":{"line":70,"column":1},"source":"index.js","original":{"line":59,"column":0}}],"sources":{"index.js":"import {Elm} from './Main.elm';\n\nconst webSocketAddress = process.env.CHAT_SERVER_WEB_SOCKETS_ADDRESS;\n\nconst app = Elm.Main.init();\n\nlet connection = null;\n\nfunction close() {\n  if (connection && connection.close) {\n    connection.close();\n    connection = null;\n  }\n}\napp.ports?.close.subscribe(close);\n\nfunction getNewConnection() {\n  try {\n    console.log(webSocketAddress)\n    return new WebSocket(webSocketAddress)\n  }\n  catch(e) {\n    console.error(e);\n    app.ports?.receive.send({\n      type: 'FAILED_TO_CONNECT'\n    });\n  }\n}\n\napp.ports?.connect.subscribe((message) => {\n  close();\n  connection = getNewConnection();\n\n  connection.addEventListener('close', () => {\n    app.ports?.receive.send({\n      type: 'DISCONNECTED'\n    });\n  });\n\n  connection.addEventListener('message', (event) => {\n    const payload = JSON.parse(event?.data);\n\n    if (typeof payload === 'string') {\n      app.ports?.receive.send({\n        type: 'CONNECTED',\n        userId: payload,\n      });\n    }\n    else {\n      app.ports?.receive.send(payload);\n    }\n  });\n\n  connection.addEventListener('open', () => {\n    connection.send(JSON.stringify(message));\n  });\n});\n\napp.ports?.send.subscribe((message) => {\n  if (connection && connection.send) {\n    connection.send(JSON.stringify(message));\n  }\n});\n"},"lineCount":null}},"error":null,"hash":"8a500d458f8dbbc9d9e808a875845756","cacheData":{"env":{"CHAT_SERVER_WEB_SOCKETS_ADDRESS":"ws://localhost/api/"}}}